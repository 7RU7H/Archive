# Static Analysis Evasion Techniques

#### Changing the hash

Bypassing a hash-based detection mechanism

- Changing the code and recompiling
- Compiling with another compiler
- Binary patching of the .data section to change functionality - without needing to recompile
- Binary patching bits of data across the entire binary
	- Context-Triggered Piecewise Hashes - [Malware Detection: Context Triggered Piecewise Hashes (CTPH) A CTPH is a rolling hash and involves multiple traditional cryptographic hashes for one or more fixed-size segments in a file. One of the most popular CTPH methods is ssdeep.](https://medium.com/asecuritysite-when-bob-met-alice/malware-detection-context-triggered-piecewise-hashes-ctph-9bc4da234111)

#### Evading Anti-Virus Signatures

- [[Malware-Techniques-Obfuscation]]
- Binary Patching

#### String Obfuscation

To avoid burning infrastructure based on single-string search.

- Decoding a runtime
- [[Malware-Techniques-Obfuscation]]

#### Runtime loading DLLs

To bypass PE Header analysis - consider [[Malware-Analysis-PE-Headers]]; loading DLLs at runtime with `LoadLibrary`, `LoadLibraryEx` or custom API calls to load DLLs at runtime.

- Loading DLLs at runtime


#### Packing and Obfuscation

- [[Malware-Techniques-Obfuscation]] 
- [[Malware-Techniques-Packing]]


## References

[Prof Bill Buchanan OBE - Malware Detection : CTPH medium article](https://medium.com/asecuritysite-when-bob-met-alice/malware-detection-context-triggered-piecewise-hashes-ctph-9bc4da234111)
[THM Advanced Dynamic Analysis Room: Debugging](https://tryhackme.com/room/advanceddynamicanalysis)