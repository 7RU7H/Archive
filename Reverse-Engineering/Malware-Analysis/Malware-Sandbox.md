# Malware Sandbox

Probably best practice to have entire dedicated host machine for Malware Analysis. Although [[Hypervisor-Escapes]] exist, why gamble a good machine(s) or hardware. 

## Sandboxes

Sandboxes allow Malware Analysts to perform Dynamic Analysis that is more representative of the actual execution chain of a piece of malware by creating of safe and containerised or virtualised environment for the malware to operate in to then monitor it. Sandboxes within network meaning that any unsafe or suspicious file run simulation without causing harm before it is run on a production system. 

Types of Sandboxes include Firewalls, Mail Servers and Workstations they are run in parallel by segmented from the actual network. These are replicas of elements of a network that malware targets. For example a Sandbox Mail Server that opens phishing emails containing suspicious links or files or command injection. 

#### Sandbox Qualities

- An isolated machine
- Snapshots
- Monitoring tools
- Safe and good disciplined practice of file sharing for data capture.
	- More isolated the option to share files the safer for all involved

#### Sandbox Product list:

Note these were listed by THM, will try to add more if they are maintained 

- [Cuckoo's sandbox](https://cuckoosandbox.org/) *is the most widely known sandbox in the malware analysis community"*
	- [Online Cuckoo Sandbox](https://cuckoo.cert.ee/)
- [CAPE Sandbox](https://github.com/kevoreilly/CAPEv2) - more advanced version of Cuckoo's sandbox supporting memory dumps, debugging and unpacking of packed malware.
	- [Online CAPE Sandbox](https://www.capesandbox.com/)
-   Palo Alto Wildfire ([Firewall](https://www.paloaltonetworks.co.uk/products/secure-the-network/wildfire))
-   Proofpoint TAP ([Email Sandbox](https://www.proofpoint.com/uk/products/advanced-threat-protection/targeted-attack-protection))
-   Falcon Sandbox ([EDR/Workstation](https://www.crowdstrike.co.uk/products/threat-intelligence/falcon-sandbox-malware-analysis/))
-   MimeCast ([Email Sandbox](https://www.mimecast.com/))
-   VirusTotal ([Sample Submission Site](https://www.virustotal.com/))
-   Any.Run ([Sample Submission Site](https://any.run/))
-   Antiscan.me ([Sample Submission Site](https://antiscan.me/))
-   Joe Sandbox ([Sample Submission Site](https://www.joesandbox.com/))

More Online Sandboxes:
-   [Any.run](https://any.run/)
-   [Intezer](https://analyze.intezer.com/)
-   [Hybrid Analysis](https://hybrid-analysis.com/)

See the article: [[Sandbox-Evasion]] for more on evasive techniques.

## References

Give then the reference contain sites that have malware samples full links are displayed

https://www.paloaltonetworks.co.uk/products/secure-the-network/wildfire
https://www.proofpoint.com/uk/products/advanced-threat-protection/targeted-attack-protection
https://www.crowdstrike.co.uk/products/threat-intelligence/falcon-sandbox-malware-analysis/
https://www.mimecast.com/
https://www.virustotal.com/
https://any.run/
https://antiscan.me/
https://www.joesandbox.com/
https://www.paloaltonetworks.co.uk/products/secure-the-network/wildfire
https://www.proofpoint.com/uk/products/advanced-threat-protection/targeted-attack-protection
https://www.crowdstrike.co.uk/products/threat-intelligence/falcon-sandbox-malware-analysis/
https://www.mimecast.com/
https://www.virustotal.com/
https://any.run/
https://antiscan.me/
https://www.joesandbox.com/