# Payloads

[[Metasploit]] formats for [[MSFvenom-Payloads]]
```ruby
windows/x64/shell_reverse_tcp # Stageless
windows/x64/shell/reverse_tcp # Staged
```

## Staged

A staged payload embeds stagers, intermediary shellcode, which step through till final payload. Useful when...:
- Smaller than stageless
- Final shellcode is not embedded - if payload is compromised by defenders they only have up to the Nth stager
- Shellcode is loaded into memory
- Staged payload can be reused by replacing final shellcode.


Create SSL certificate
```bash
openssl req -new -x509 -keyout localhost.pem -out localhost.pem -days 365 -nodes
```
Run a python HTTPS server
```python
python3 -c "import http.server, ssl;server_address=('0.0.0.0',443);httpd=http.server.HTTPServer(server_address,http.server.SimpleHTTPRequestHandler);httpd.socket=ssl.wrap_socket(httpd.socket,server_side=True,certfile='localhost.pem',ssl_version=ssl.PROTOCOL_TLSv1_2);httpd.serve_forever()"
```

## Stageless

A stageless payload embeds the final shellcode directly into itself. Useful when...:
- Only need the shellcode to execute
- Does not require additional network connections
- When network connectivity is restrictive and you require a single packet

## References

[THM AV evasion shellcode](https://tryhackme.com/room/avevasionshellcode)