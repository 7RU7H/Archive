[IDA and Malware Reverse Eng. 101 by Jake Williams](https://www.youtube.com/watch?v=h8CkxCpnxes) : *"IDA and Malware Reverse Eng. 101 training by Jake Williams during the DEF CON Red Team Village and Texas Cyber Jungle event. Red Team Village Website: [https://redteamvillage.io](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqbnZmVGpFV1R5eV9EblBPWXlNbmVCRmhiSFJQQXxBQ3Jtc0tsUjREcjJwZWc5cVVVWk1mVzIwZzNkbmlGQ1hJOWJLZ2Y3T0dCc3ZCRU9ReGJXMldocjNRMWwtc2NjZ0IyaEpzV0dUdDNXc2ZSaVRpeTdoXzBlLWVBTThNRl9ZdnVvel83dHEyS1VYY2VTejYxVFdNOA&q=https%3A%2F%2Fredteamvillage.io%2F&v=h8CkxCpnxes) Twitter: [https://twitter.com/VillageRedTeam](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqa2tTbV9HeEQ3cHlkN0dybkNzRlZVMVZ0a3luZ3xBQ3Jtc0trcEI1dnQ3bW4zei11Uk9URWRGbHFQUkdUcXBENXVyWHdfcjdqNDZuc3NzeUdjNzlNazZJUE0wdllIenM5MldZajRTd1dTOG8xeE5LcGpHQlF4cGsxS3dGNC00a1d3SnVFTExGZTM4RnlfQ3JFR3poQQ&q=https%3A%2F%2Ftwitter.com%2FVillageRedTeam&v=h8CkxCpnxes) Discord: [https://redteamvillage.io/discord](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqbnY4SDR6T0RaVTRRb3ZkV0dicEZFNzNaUS05QXxBQ3Jtc0tub29QM1ZlUVk3Yml0TGtkRnJSWllOeHYwWWlTLWFXZXVPMVZfSC1Lc2FxMkRlYzRXSTQzeGJZYkRkWXBIQ1NIaTJJTGxKU0E3TGxVVms4VjJMR0FjV0RDT0o0OWJaQ1FZaGJDVGgtY3lZVWxRVHBsQQ&q=https%3A%2F%2Fredteamvillage.io%2Fdiscord&v=h8CkxCpnxes) Twitch: [https://twitch.tv/redteamvillage](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqa1pvRnNnS2pNUFpZWjNVSnlJbjJybTFfRU9EUXxBQ3Jtc0tseFZSNXB5WHdRSzRCNXI1YXBHbkpoVm1lN2dQTDl6U2h3WkFfNHRCZnlBWXJscDJKTkJkYXI3SE1RamlORWRWMG5WdVcxYVl5Ui1SZUh6NGZZNk1PRXNvYnJNc3lBcFZIR1BEWDNZLVZEUTVpVGVkSQ&q=https%3A%2F%2Ftwitch.tv%2Fredteamvillage&v=h8CkxCpnxes)"*

Best practice : have dedicated machine and infrastructure

- Beware OPsec or Security issues- disconnect from internet!
- Change your background colour if you are using a VM 
	- This could also be a check that malware actually does to check it is in a sandbox. This video is two years old as of 2023.
- Sometimes some software passed to Malware Analysts is not Malware.
- Drag and Drop Discipline
	- There are those Malware Reversers that has dragged and drop Malware onto host machine and those have not **yet**.
	- Change extension:
		- `sample.exe -> sample.ex$ -> sample.exe`
- Snapshots! 
- Do not require Licence 

This is not [soup to nuts](https://en.wikipedia.org/wiki/From_Soup_to_Nuts) Malware Reverse Engineering this an introduction:

- Static Properties Analysis
	- Static Properties Analysis for exposing functionality that can not be observed in a Sandbox.
	- Indicators are purely expert knowledge pieces that signs of Malware not indicative of Malware - *"Malware Gang Signs"* - you need lots of indicators not just one indicator.
	- PEStudio - expert knowledge system - Beware OPsec or Security issues - disconnect from internet! 
		- Check `compiler-stamp` for [[Timestomping]] or Vanity Timestamping - custom timestamps 
		- What security context is the binary wanting to run as?
		- Libraries - Which libraries and why? - [[Search-Engine-Dorking]] of *"how would  Malware use X.dll?*
			- ws2_32.dll - winsock for low level sockets
			- wininet.dll - use the users proxy settings for free! 
		- Imports - API calls
			- [[Malware-Sandbox]]es limited as if the for example Malware requires contacts from Outlook and requires Outlook to be open the Sandbox will keep you safer, but not expose functionality. 
			- Importing by ordinal (`$int $name`) - rare expect in Microsoft software 
			- What API calls that:
				- ControlService and DeletedService - create and delete services 
				- LockResource - embed resources in the binary might indicate data being dropped
				- RegSetValueExW, RegDeleteValueExW - changes keys for persistence
				- UrlDownloadToFile
				- CreateProcess, Process32(First|Next)W and TerminateProcess (remote process termination)
				- InternetConnect, InternetReadFile
				- (Read|Write)ProcessMemory - code injection
				- CallNextHookEx, SetWindowHookExW, UnhookWindowsEx - anti-debugging and [[Keylogging]]
				- Find(First|Next)File - directory listings 
		- Sections 
			- Section hashes 
				- Binary patching of the data section 
					- Muilt
					- The data changes for callback domain, but the code does not
		- Strings 
			- Some [[Malware-Techniques-Packing]] go in and out of fashion depending on detection trends 
				- *"Even Grandma, god rest her soul knows about*" [run key](https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys) - Registry keys to make program run on user log on.
				- \\WOW6432Node
					- Windows-On-Windows subsystem 32 bit executable with 64 bit subsystem 
					- Separate Registry hive
				- Encoding and Keys
					- For example: `A-Za-z0-9+/` base64 
		- Combining everything together

https://www.youtube.com/watch?v=h8CkxCpnxes - 35:42


## Appendix

List of MalwareJake applications with installation instructions
```
Firefox 
IDA Freeware
Immunity Debugger
malzilla.exe 
PEID
Process Hacker
x64dgb
scdbg
RegShot
Scylla x32
Scylla x64
Process Monitor
Ghidra
API Monitor x64
API Monitor x32
Detect It Easy
CyberChef
ExeInfo PE
PEStudios
```

[[API-Monitor]]
[[Ghidra-Cheatsheet]]
[[Sysinternals-ProcMon]]

## References

[IDA and Malware Reverse Eng. 101 by Jake Williams](https://www.youtube.com/watch?v=h8CkxCpnxes)
[Wikipedia "soup to nuts" phrase](https://en.wikipedia.org/wiki/From_Soup_to_Nuts)