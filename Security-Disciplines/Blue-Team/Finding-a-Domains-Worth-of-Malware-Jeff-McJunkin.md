

# Finding a Domain's Worth of Malware - Jeff McJunkin

[Youtube Finding a Domain's Worth of Malware - Jeff McJunkin](https://youtu.be/DgxZ8ssuI_o):

https://www.wildwesthackinfest.com/

Are you tired of demonstrations of products that take months or years to get effective data from? How many products have you seen half-implemented (but fully paid for!) that didn’t ever deliver any real value to your organization? Here, I’ll discuss multiple free products that you can use next week to find evil inside your organization. Some techniques will find less advanced adversaries, and some will trip up even some of the most advanced ones - but they’ll all deliver value in less than a week of implementation, and I’ll discuss how you can integrate them and find the malware you already have in your environment. “Assume breach”...then find it!

Jeff McJunkin @jeffmcjunkin is Founder of Rogue Valley Information Security with more than nine years of experience in systems and network administration and network security. His greatest strength is his breadth of experience - from network and web application penetration testing to digital/mobile forensics, and from technical training to systems architecture. Jeff is a computer security/information assurance graduate of Southern Oregon University and holds many professional certifications. He has also competed in many security competitions, including taking first place at a regional NetWars competition and a U.S. Cyber Challenge capture-the-flag competition, as well as joining the Red Team for the Pacific Rim Collegiate Cyber Defense Competition. His personal blog can be found at http://jeffmcjunkin.com/.

Detection engineering is not just something to strive towards and build over months and years. There immediate off-the-shelf software and freely shared knowledge; Infosec freely shares - use it!

Threat model properly:
- Persistent Malware not caught
- Advanced LOLBAS
- Shadow IT

#### Hunting

- Find Anomalous Behavour
- Attackers are playing minesweeper vs Blue team view of Mitre Attack TTPs (easily overwhelming)
- Use deceptive techniques like honeypotting

#### Google Rapid Response

Remote Live Forensics - 50%~ Mitre Framework coverage
- OSquery integration

You can't really hide executing in memory, less there is no hunt to network attacks 

#### RITA - blackhills

Aid, but not replace IR or Threat Hunters

Build a good white list you will find false positives

1. First Pass
	1. Image a new workstation
	2. Install wireshark
	3. Log in and open all regular applications
	4. Record all traffic for >=24 hours
	5. Import in to Zeek, analyze with RITA, whitelist beacon traffic
2. Second Pass
	1. Capture a weeks worth of traffic
	2. Analyze with Zeek
	3. Filter out beaconing traffic using SplitCap or for linux
3. Third Pass
	1. Filter with RITA

#### Finding unique ssl client with ja

From ja3er.com - The JA3 algorithm takes a collection of settings from the SSL client hello such as SSL/TLS version, accepted cipher suites, list of extensions, accepted elliptic curves and elliptic curve formats.



