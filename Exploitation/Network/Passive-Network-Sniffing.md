# Passive Network Sniffing

#### Retrieve all network interfaces

Linux 
```bash
ip a
# Legacy systems
ifconfig
```

#### Sniff Network Traffic

Windows - DOS
```powershell
ipconfig
```

Windows - Powershell
```powershell
Get-NetIPConfiguration 
Get-NetIPAddress
```

TCPDUMP is a cross-platform - [tcpdump for windows](https://appsource.microsoft.com/en-us/product/web-apps/microolap.tcpdump?tab=overview)
```bash
tcpdump -i $interface
# Verbose and written ot a .pcap
tcpdump -A -i $interface -w /tmp/snifferings.pcap 
```

netsh - deprecate Windows CLI utility 
```powershell
# Use netsh trace to capture network traffic
netsh trace start capture=yes
# Stop
netsh trace stop
# Max cpature size
netsh trace start capture=yes maxSize=2048
# Run post reboot
netsh trace start capture=yes persistent=yes
```

## References

[THM L2 MAC Flooding and ARP Spoofing](https://tryhackme.com/room/layer2)
[zendesk - netsh packet capture](https://netmotionsoftware.zendesk.com/hc/en-us/articles/360050738033-Performing-a-Network-Packet-Capture-With-netsh-trace)
[appsource.microsoft - tcpdump for windows](https://appsource.microsoft.com/en-us/product/web-apps/microolap.tcpdump?tab=overview)
[learn.microsoft - netsh](https://learn.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-contexts)