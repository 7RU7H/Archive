# MAC Flooding

A [MAC flooding](https://en.wikipedia.org/wiki/MAC_flooding) attack is a technique to compromise the security of network switches by forcing legitimate MAC table contents out of the witch and forcing [Unicast flooding](https://en.wikipedia.org/wiki/Unicast_flood) behaviour (*when a switch receives a unicast frame and treats it as a broadcast frame, flooding the frame to all other ports on the switch*). This can potential send sensitive information to portions of the network where it is not normally intended to go. MAC flooding is suspicious layer 2 traffic and can be easily detected on and the port could also get blocked by the network device and result in an  DoS. *If* successful: the switch will resort to fail-open mode and temporarily operate similarly to a network hub â€“ forwarding all received frames to every connected port (aside from the port the traffic originated from). As it is operating like a hub an adversary could sniff network traffic between other hosts that normally wouldn't be received by their device if the switch were functioning properly.

1. Network Engineers generally do not like you even breathing on their hardware out of fear these attacks are unstable and volatile beware
2. MalwareJake's "Do no harm" - your attack path is also harmed.
3. If you really must:
	- Check if it is a switch and not a virtual bridge **AND**
		- If switch is consumer or prosumer (unmanaged) switch **OR** not configured for packet inspection like Dynamic ARP inspection (DAI) **AND**
		- Is in scope. MalwareJake says *"even if it is scope customers still get upset"* 
			- Just because it is in scope does not mean you should try it
			- Just because it is a sexy attack does not mean that it is best

Ettercap with `rand_flood` plugin:
```bash
ettercap -T -i $interface -P rand_flood -q -w /tmp/farewellSwitch.pcap
```

There is also [macof](http://manpages.ubuntu.com/manpages/bionic/man8/macof.8.html) for Ubuntu.


## References

[THM L2 MAC Flooding and ARP Spoofing](https://tryhackme.com/room/layer2)
[Wikipedia - MAC flooding](https://en.wikipedia.org/wiki/MAC_flooding)
[Wikipedia - Unicast flooding](https://en.wikipedia.org/wiki/Unicast_flood) 