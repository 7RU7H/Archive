# Windows based Buffer Overflows

Finding the vulnerability:
1. Source code review
	1. Find vulnerable functions
2. Fuzzing
	1.  Fuzz any input fields
3. Reverse Engineering
	1. Find vulnerable functions


## Fuzzing HTTP protocol
[Microsoft TCPView](https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview) if debugger network listening does not work.

1. Use Wireshark to monitor traffic sent to application and follow TCP stream to show reply. 
2. Python PoC 
3. Run debugger Administrative priveleges attached to running of the vulnerable application

## Win32 Buffer Overflow Exploitation
Be aware alot of restarting required.
1. Enumerate till location EIP
	1. Binary Tree analysis - use pwntools `cyclic` or `msf-pattern_create -l $int`
	2. Update PoC
1. Check offset with `msfpattern_offset -l $int -q $offsetpattern` or pwntools `offset`
	1. Add EIP variable to find exact EIP address.
1. Locating space for shellcode
1. Check for bad characters
1. Redirect the execution to flow:
	
Due address changing either due crashing-and-restarting application or ASLR ... we can just hardcode a static return address in general in modern binary exploitation.

6. Find a return address
7. Leverage a static address that contains a `JMP ESP`
	1. Must be static - no libraries compiled with ASLR support
	2. Not an address within the region to be occupied by the shellcode