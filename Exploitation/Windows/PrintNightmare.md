PrintNightmare (CVE-2021-1675) and (CVE-2021-34527) affect the [Print Spooler service](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-prsod/7262f540-dd18-46a3-b645-8ea9b59753dc). It is a service - one of many [[Windows-Services]]- manages the printing processes, which is responsible are managing print jobs. This task is recieving files to print, scheduling printing, printer resource inventory checking and printing files in organised queue. Print spooler service operatates in client-server model with print clients, administrative client and print servers. It is **enabled dy default** in all Windows Clients and Servers. Third party software and drivers provided by the printer manufacturers do not require Print Spooler services, but most use it. Domain Controllers of AD - [[Active-Directory]] - mainly use Print spooler service for printer pruning, which is the task of out-of-use printers removing being used by accident by users.

## The Vulnerability

The PrintNightmare vulnerability [CVE-2021-1675](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675) and [CVE-2021-34527](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527) are related, with the same name: "Windows Print Spooler Remote Code Execution Vulnerability" and both related to Print Spooler. Microsoft's definintion of the  CVE-2021-34527 vulnerability: 

*"a remote code execution vulnerability exists when the Windows Print Spooler service improperly performs privileged file operations. An attacker who successfully exploited this vulnerability could **run arbitrary code** with SYSTEM privileges. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights."*

Whereas CVE-2021-1675 requires direct local access (i.e usb rubber ducky) to the machine to transfer and use a malicious DLL files to escalate privileges, CVE-2021-34527 can do so remotely.

## References

[PrintNightmare THM Room part 1](https://tryhackme.com/room/printnightmarehpzqlp8)
[PrintNightmare again! THM part 2](https://tryhackme.com/room/printnightmarec2bn7l)
[MSRC CVE-2021-1675](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675)
[MSRC CVE-2021-34527](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)