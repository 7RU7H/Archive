
Requires [[Compiling-Exploits]] or [[Microsoft-Visual-Studios]] 2019! - 4.5 not supported by 2022 onwards

Beware of the [CLSIDs](https://learn.microsoft.com/en-us/windows/win32/com/clsid-key-hklm): *A CLSID is a globally unique identifier that identifies a COM class object. If your server or container allows linking to its embedded objects, you need to register a CLSID for each supported class of objects.* Regiestry Key found here: `HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{CLSID}`


https://github.com/foxglovesec/Potato.git
https://github.com/antonioCoco/RoguePotato.git
https://github.com/ohpe/juicy-potato.git
https://github.com/breenmachine/RottenPotatoNG.git
https://github.com/CCob/SweetPotato.git
https://github.com/micahvandeusen/GenericPotato.git
https://github.com/itm4n/PrintSpoofer.git

[JuicyPotatoNG](https://github.com/antonioCoco/JuicyPotatoNG) and the [Blog](https://decoder.cloud/2022/09/21/giving-juicypotato-a-second-chance-juicypotatong/)

User requires either SeAssignPrimaryTokenPrivilege or seImpersonatePrivilege to impersonate System. These privilege are used legitimately for patching by services and software to perform task that require system level access. The exploit attempt to activate a local [COM object](https://en.wikipedia.org/wiki/Component_Object_Model) (a binary interface to for inter-process communication) using an SSPI hook on _[AcceptSecurityContext()](https://learn.microsoft.com/en-us/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext)_ function to then force an authentication attempt that is capture by the exploit and abuse to elevate to system to perform a specified command by user.


## References

[jlajara](https://jlajara.gitlab.io/Potatoes_Windows_Privesc)
[Decoder Blog about JuicyPotatoNG](https://decoder.cloud/2022/09/21/giving-juicypotato-a-second-chance-juicypotatong/)