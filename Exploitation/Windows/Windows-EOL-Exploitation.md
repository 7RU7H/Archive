# Windows EOL Exploitation

[[Windows-EOL]] exists, but people and company have budgets were upgrading to a more secure Windows would involve massive costs due to: 
- Software Licencing
- Different Software

Server 2008 - 2019 Security Feature comparison table from [HTB Academy](https://academy.hackthebox.com)

| Feature                                                                                                                                                             | Server 2008 R2 | Server 2012 R2 | Server 2016 | Server 2019 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------- | -------------- | ----------- | ----------- |
| [Enhanced Windows Defender Advanced Threat Protection (ATP)](https://docs.microsoft.com/en-us/mem/configmgr/protect/deploy-use/defender-advanced-threat-protection) |                |                |             | X           |
| [Just Enough Administration](https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/jea/overview?view=powershell-7.1)                                 | Partial        | Partial        | X           | X           |
| [Credential Guard](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard)                                         |                |                | X           | X           |
| [Remote Credential Guard](https://docs.microsoft.com/en-us/windows/security/identity-protection/remote-credential-guard)                                            |                |                | X           | X           |
| [Device Guard (code integrity)](https://techcommunity.microsoft.com/t5/iis-support-blog/windows-10-device-guard-and-credential-guard-demystified/ba-p/376419)       |                |                | X           | X           |
| [AppLocker](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview)                  | Partial        | X              | X           | X           |
| [Windows Defender](https://www.microsoft.com/en-us/windows/comprehensive-security)                                                                                  | Partial        | Partial        | X           | X           |
| [Control Flow Guard](https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard)                                                                       |                |                | X           | X           |

Patch levels of older systems is critical for exploitation
```powershell
wmic qfe


Set-ExecutionPolicy bypass -Scope process
Import-Module .\Sherlock.ps1

# Get the Patch level for WESNG
systeminfo > C:\programdata\sysinfo.txt
# Or
get-computerinfo > C:\programdata\sysinfo.txt
```
[Sherlock](https://github.com/rasta-mouse/Sherlock),[Windows-Exploit-Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester), WESNG [[WESNG-Helpsheet]]

SMB versions and signing may not be secure! 

[[Metasploit]] is very relevant in legacy Windows Exploitation.
## References

[HTB Academy](https://academy.hackthebox.com)
[Sherlock](https://github.com/rasta-mouse/Sherlock)