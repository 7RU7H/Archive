# Active Directory Exploitation
For information about AD check out [[Active-Directory-Defined]]:
For enumeration see [[Active-Directory-Enumeration-Defined]] or general theory and definitions [[Active-Directory-Defined]]. For commands cheatsheet [[Active-Directory-Commands]] or for Privilege Escalation see [[Active-Directory-Privilege-Escalation]]. See [[Attacking-Kerberos]] for exclusively Kerberos related and  information on the mechanics of Kerberos  [[Active-Directory-Kerberos-Defined]]. See [[Active-Directory-Footholding]] for Post Enumeration phase.

## Domain Exploitation
[[AD-Domain-Exploitation]] is in this subarticle.

## Kerberos Related
[[Attacking-Kerberos]] in this subarticle or for individual attacks [[Overpass-The-Hash]] and [[Pass-the-Ticket]]

## Red Team Standards
[[Red-Team-Tooling]] and [[Red-Team-Weaponization]]

## Credential Injection 
The  `runas.exe` with AD credentials of a user of a AD forest.
```bash
runas.exe /netonly /user:<domain>\<username> cmd.exe
```

The flag `/netonly` allows loading of credentials for network authentication, but will not be verified directly by a DC. If hosting a Windows Box tt is required to when run with Administrative privileges.


When using a Windows Box you can verify the credentials by listing `SYSVOL`. Any account and Domain-joined computers  can read `SYSVOL`, it is located on the DC and is a shared folder storing the Group Policy Objects (GPOs).

But we may need to configure DNS if is has not been through VNP or DHCP 
 
```powershell
$dnsip = "<DC IP>"
$interface = "<Interface>"
$index = Get-NetAdapter -Name $interface | Select-Object -ExpandProperty 'ifIndex'
Set-DnsClientServerAddress -InterfaceIndex $index -ServerAddresses $dnsip
```
Then
```terminal
nslookup $domain\SYSVOL\
dir \\$domain\SYSVOL\ # This will list SYSVOL
```
With DNS this attack provide the hostname, network authenication that will attempt a Kerberos authentication ashostname are used in ticketing, whereas with IP we can force NTLM authenication. It is worth being aware theat monitoring for OverPass and Pass-The-Hash techniques occurs so NTLM authenication help avoid detection.



[S1ckB0y1337](https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet#domain-enumeration)