Golden tickets are forged Ticket Granting Tickets (TGTs) as part of Kerberos, see [[Active-Directory-Kerberos-Authentication-Defined]] and it one of many techniques of [[Attacking-Kerberos]]. It is a ticket that grants any ticket, which requires KRBTGT accounts password hash, maybe try [[Mimikatz-Cheatsheet]]. This article is notes on the subject of Golden Tickets:

PAC (Privilege Attribute Certificate) is an extension of Kerberos protocol this is transmitted as a summary in the TGT and TGS. It specifies access of an account.

#### Words of Warning

*When forging tickets, before November 2021 updates, the user-id and groups-ids were useful but the username supplied was mostly useless. As of Nov. 2021 updates, if the username supplied doesn't exist in Active Directory, the ticket gets rejected. This also applies to Silver Tickets.* - [thehackerrecipes](https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/silver)



Requirements:
- KRBTGT account's password hash
- domain name, domain SID, and user ID of account to be impersonated

- With KRBTGT user hash - we don't need the password hash of the account we want to impersonate, it was signed by the KRBTGT hash, this verification passes and the TGT is declared valid no matter its contents.
- KDC will only validate the user account specified in the TGT **if the account is older than 20 minutes**
	- Allowing for disabled, deleted, or non-existent account in the TGT 
- TGT no older than 20 minutes!
- TGT sets the policies and rules, Golden Tickets can overwrite the KDC 
- By default, the KRBTGT account's password never changes
	- Blue team would have to rotate the KRBTGT account password atleast twice, is an incredibly painful process for the blue team
		- Not all services are smart enough to release the TGT is no longer valid (since the timestamp is still valid) and thus won't auto-request a new TGT.
- Golden Tickets allow even bypass smart card authentication as smart cards are verified by the DC before it creates the TGT.
- Golden ticket can created non domain joined machines!

With a Golden ticket the first interaction is a TGS-REQ using the TGT (Golden Ticket), there is no prior credential submission or AS-REQ / AS-REP. The DC checks and verifies it. It is considered a important persistence method see [[AD-Persistence-Tickets]].


## References

[THM AD Persistence Room](https://tryhackme.com/room/persistingad)
[Kerberos and Attacks 101 by Tim Medin](https://www.youtube.com/watch?v=9lOFpUA25Nk)
[Hackndo - Golden and Silver tickets](https://en.hackndo.com/kerberos-silver-golden-tickets/)
[thehacker.recipe - Golden Tickets](https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/golden)