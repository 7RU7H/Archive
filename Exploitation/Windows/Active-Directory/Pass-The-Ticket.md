## Pass The Ticket 
The Pass the Ticket attack uses the TGS exported and re-injected elsewhere on the network and then used to authenticate to a specific service, no administrative privileges required. Does not provide addition access, but the flexibility to **CHOOSE** a machine to use the ticket from. If a service is registered with a Service Priniciple Name SPN, we could crack the service acount password hash and obtain the password from the service ticket then gaining access to the resources([[Active-Directory-Credential-Caching]],[[Windows-System-And-Service-Privileges]],[[Active-Directory-Default-Security-Groups-Table]] and any other AD object) of the service account. An Application on the server trusts the integrity of the service ticket, theoretically only known to the service account and the domain controller. Therefore using the service account the application will detirmine permission based on group memberships present in the service ticket. 

With service count passowrd or its associated NTLM hash we can forge the a service ticket to access the target resource with any permissions wanted, custom-created tickets are called silver tickets, the silver ticket can be leveraged any server where the SPN is used. Once again [[Mimikatz-Cheatsheet]] Don't be confused `kerberos::golden` is for Silver Ticket Attacks, see Golden Ticket Attacks. Requires:# Username, Domainame, SID of Domain defined by all except the ultimate `-0000`, Service to target, Service type(eg. HTTP), password hahsh of the Service Account. Creating a service ticket for the SPN HTTP/WebServer.Domain.com with this technique from perspective of application the current user will be built-in local administrator and Domain Admin group member.

```powershell
kerberos::purge
kerberos::list

kerberos::golden /user:$user /domain:$domain.com /sid:$SID-minus-exception /target:$TargetServer.$domain.com /service:$servicetype /rc4:$passwordhash-of-spn /ptt # /ptt means directly injected into memory
```

Sometimes extraction of Kerberos tickets and sessions keys from LSASS memory with Mimikatz, requiring also SYSTEM privileges:
```powershell
privilege::debug
sekurlsa::tickets /export
```
Extract a desired ticket and inject the tickets into the current session, which doesn't require administrator privileges:
```powershell
kerberos::ptt [0;427fcd5]-2-0-40e10000-Administrator@krbtgt-$DOMAIN.kirbi
```
Use `klist` to list Kerberos tickets.

## References

[THM Lateral movement and pivoting](https://tryhackme.com/room/lateralmovementandpivoting)