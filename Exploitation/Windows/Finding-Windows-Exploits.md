
# Finding Windows Exploits

This article is based from watching [Wild West Hackfest 2020: Hunting Software Vulnerabilities without Reversing by Jake Williams](https://www.youtube.com/watch?v=JPhrKJzNJyw); firstly to avoid getting too excited at potential finding a 0day download from [majorgeeks](https://www.majorgeeks.com/) site 100% spyware free. Jake Williams is awesome and this talk is pretty recent, very positive and insightful.


## Tools

Window IE Environment - standardise testing!

regshot snapshots the registry
use fast ssd nvme VM for `scan dir` option REQUIRED. Compare registry changes

procmon, real time register changes, less noisy than sysmon
- process create filter, filter iut more noise

process hacker - check dll, edit memory on the fly
- if x86 and x64 components it should be in programs folder
memory tab of process hacker you can find string you were looking for - live jex editor

`netsh` is `tcpdump` with process ids

The power of combination:
- regshot and procmon - real time and static comparison of before and after execution 

## Targets of opputunity

Firstly create the file: `c:\program.exe`; Microsoft will try to stop you, because it breaks the pathing in Windows **when software is misconfigured**, check an alert for when it is executed. The calling process from whatever hopeful third party software will be vulnerable to unquoted path - [[Windows-Privilege-Escalation-Vectors]]. `c:\program.exe` will in process of **all** be the inital lookup as:

```powershell
# Unless local directory first
C:\Program.exe # Search algorhythm will check this first
C:\Program Files\
C:\Program Files (x86)\
```
Unless it check directory the binary is called from, which if does not set the directory permission to inherit from the parent after install will probably be the permissions used to create it - the big `W`

Process calls to look for
- is the path qualified?
- is the path unquoted? 
- CreateFile (create or open) failures: 

Column | Relation | Value
--- | --- | --- 
Operation | is | CreateFile
Result | is not | SUCCESS
Path | Ends with | exe

`regshot` finds new services - process hacker has a popup on new service creation

Use `netsh` to analyze traffic insecure updates
- is it over https?
- is certificate pinned?
  - MITM the cert if is not
- is update signed?
 - if not the update does not certificate validate, swap out executable
- is signature validated?
- how validated?
 - specific Certificate fingerprint, is principle name - you can create self sign certs with any principle name


SysWow64 - x86 calls on third party good blue event monitor  commonly exploit because pathin

writing tasks and executing taskes is a race condition

if path is not explicit is then sustem hoping x


## References

[Wild West Hackfest 2020: Hunting Software Vulnerabilities without Reversing by Jake Williams](https://www.youtube.com/watch?v=JPhrKJzNJyw)