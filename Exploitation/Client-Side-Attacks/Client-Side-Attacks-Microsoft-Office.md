
# Client Side Attacks Microsoft Office

Microsoft Office client side attacks are often successful as it is difficult to differentiate malicious content from benign, leveraging regular user innocence in regarding the *joke* horror of [[Useful_Visual_Basic_for_Applications]] scripts, and VBA is native Windows and living off the land strategy uses the current environment against itself.

## Making Macros

The Microsoft Word `macro` may be one the oldest and best-known client-side software attack vectors. `macros` allow users to accomplishs task progromatically, from filling out spreadsheets to instatiating templates with contents. Organisations use `macro`s to link documents with external content and manage dynamic content. To create a macro go to `View -> Macros -> Create`. For more on VBA scripting see [[Useful_Visual_Basic_for_Applications]]

## Object Linking and Embedding 
Abuses of [Dynamic Data Exchange](https://docs.microsoft.com/en-us/windows/win32/dataxchg/about-dynamic-data-exchange?redirectedfrom=MSDN) (DDE) can execute arbitray application from within Office Documents, patched since 12/2017. However Object Linking and Embedding (OLE) document-embedding feature can abused to embed a batch file. Batch files were replaced by VBscript and Powershell, but  still functional in Windows 10. To accomplish this: `Insert -> Object -> Create from File -> Browser to .bat file -> Ok`, we be more stealthy by Changing the icon like the teenage hack you are with ticking the `Display as Icon` and `Change Icon...`  to select a specific icon. We can also enter a caption in the `Change Icon` popup. Users will see the Captioned name not the actual name. They will be prompted with a security warning as to whether to `Run` or `Cancel`. 

## Evading Protected View
To bypass restriction on documents entering a network through email or download link an attacker would also have to bypass protected view to accomplish any of the above. [Protected View](https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653) disables: All editing and modifications ni the document and block the execution of macros or embedded objects. A victim can press Enable Editing to exit, but [[Social-Enigeering]] maybe required. Instead of Word use Publisher, which allows for embedded objects, but without Protected View. Although [Office App Policies can be  set to prevent this too so hide your csharp and hide golang](https://docs.microsoft.com/en-us/mem/intune/apps/app-office-policies) and Publisher is less frequently installed.


## References
[Dynamic Data Exchange](https://docs.microsoft.com/en-us/windows/win32/dataxchg/about-dynamic-data-exchange?redirectedfrom=MSDN)
[Polices for Office Apps](https://docs.microsoft.com/en-us/mem/intune/apps/app-office-policies
[Protected View](https://support.microsoft.com/en-us/topic/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653)