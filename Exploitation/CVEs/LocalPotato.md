# LocalPotato

The vulnerability, dubbed Local Potatoc can allow an attacker with a low-privilege account on a Windows host to read/write arbitrary files with SYSTEM privileges. It is a local privilege escalation (LPE) vulnerability in Windows was reported to Microsoft on September 9, 2022, by Andrea Pierini ([@decoder_it](https://twitter.com/decoder_it)) and Antonio Cocomazzi ([@splinter_code](https://twitter.com/splinter_code)). The vulnerability would allow an attacker with a low-privilege account on a host to read/write arbitrary files with SYSTEM privileges.

On February 13, another privilege escalation PoC was published by [BlackArrowSec](https://twitter.com/BlackArrowSec) that abuses the `StorSvc` service, allowing an attacker to execute code as SYSTEM as long as they can write a DLL file to any directory in the `PATH`.

LocalPotato [PoC](https://decoder.cloud/2023/02/13/localpotato-when-swapping-the-context-leads-you-to-system/) leverages the flaw in a special case of [[NTLM-Authentication]] called NTLM local authenication to trick privileged process into authenticating a session the attack started against a local SMB Server. If sucess the Attack can connect to the `C$` and `ADMIN$` shares.

1. 




## References

[LocalPotato](https://decoder.cloud/2023/02/13/localpotato-when-swapping-the-context-leads-you-to-system/)
[THM Local Potato Room](https://tryhackme.com/room/localpotato)
[BlackArrowSec](https://twitter.com/BlackArrowSec)
[@decoder_it](https://twitter.com/decoder_it)
[@splinter_code](https://twitter.com/splinter_code)