# Chimera

[Chimera](https://github.com/tokyoneon/Chimera) *"is a PowerShell obfuscation script designed to bypass AMSI and commercial antivirus solutions.

[[Kali]] installation
```bash
sudo apt-get update && sudo apt-get install -Vy sed xxd libc-bin curl jq perl gawk grep coreutils git
sudo git clone https://github.com/tokyoneon/chimera /opt/chimera
sudo chown $USER:$USER -R /opt/chimera/; cd /opt/chimera/
sudo chmod +x chimera.sh; ./chimera.sh --help
```

Full flags listing:
```bash
./chimera --file powershell.ps1 --all --output /tmp/payload.ps1

#  files:
-f, --file # powershell file.ps1 to obfuscate
-o, --output # override default output file location
# options:
-a, --all # same as: -l 0 -v -t -c -i -p -h -s -b -j -k -e
-l, --level # level of string manipulation (0=random,1=low,2=med,3=high,4=higher,5=insane. default: 0)
-v, --variables # replace variables with arbitrary strings, use -v </usr/share/dict/words> to utilize custom wordlist as variable name substitutions
-t, --typedata # replace data types with arbitrary strings (e.g., System.IO.StreamWriter). use -t <string,string> to include more
-c, --comments # replace comments with arbitrary strings                         use -c <custom_comments.txt> to utillized custom text instead of random strings
-i, --insert # insert arbitrary comments into every line
-h, --hex # convert ip addresses to hexidecimal values
-s, --string # obfuscate provided strings, use -s <getstream,getstring>
-b, --backticks # insert backticks into provided string, e.g., ne`w`-OB`je`cT
-j, --functions # replace function names with arbitrary strings
-d, --decimal # convert obfuscated payload to decimal format improves AMSI evasion; increases AV detection
-g, --nishang # remove nishang-specific characteristics
-k, --keywords # search obfuscated output for words that may trigger AV/VT. By default searches for common words (backdoor, payload,nishang), use -k <word,word> to include more
-r, --random # randomize character punctuation
-p, --prepend # prepend random number of spaces to lines
# misc:
-e, --examine # preview snippets of output file contents
-q, --quiet # supress non-essential messages
-z, --no-art # if you hate awesome ascii art
--help # you're looking at it
```


Usage Example
```bash
./chimera.sh -f shells/Invoke-PowerShellTcp.ps1 -l 3 -o /tmp/chimera.ps1 -v -t powershell,windows,\
copyright -c -i -h -s length,get-location,ascii,stop,close,getstream -b new-object,reverse,\
invoke-expression,out-string,write-error -j -g -k -r -p
```
## References

[Chimera - GitHub](https://github.com/tokyoneon/Chimera) 