# Privilege Escalution Defined

In the [[Lockhead-Martin-Cyber-Kill-Chain]], after intial [[Active-Directory-Footholding]] or any other Server or Machine, the next step is the increase the level of access rights on host machine. This process is called Privilege Escalution, two phase process:
1. Gathering information phase 
2. Attempting to move vertically or horizontally with information gather

Repeat the previous to processes till at the highest level of access rights.
Target machines can be consider unique given differences in operating systems, patch level, network connectivy, service operable, etc. [[Linux-Privilege-Escalation]] differs from [[Windows-Privilege-Escalation-Vectors]] and [[Active-Directory-Privilege-Escalation]] architectural, but the search for misconfigurations, permissive lack of restrictions, vulnerabilities(running or static) in software or kernel space, leaked sensitive information stored in files (log, configuration, emails, etc), databases, registery settings or hardcode credentials, and more!

Enumeration can be done manually or be automated via scripts that has output that requires to be read.

## Manual Enumeration 

1. Users
2. Hostname
3. OS version and architecture
4. Processes
5. Services
6. Scheduled Tasks
7. Networking Information
8. Firewall status and rules
9. Installed Applications
10. Patch levels
11. Readable/Writable Files and Directories
12. Unmounted Disks
13. Device Drivers
14. Kernel Modules
15. Binaries That AutoElevate
Upload

## Automated Enumeration

Script help automate the information gathering process, various are list in [[Linux-Privilege-Escalation]], [[Windows-Privilege-Escalation-Vectors]] and [[Active-Directory-Privilege-Escalation]]. Some specific script cheat/helpsheets avaliable in [[Contents]] of Archive are:

OS | Script Cheat/Helpsheet
--- | ---
Windows | [[WESNG-Helpsheet]]

## Concepts Related Comparatively to Cross-Platform Privilege Esculation Upload

Misconfigurations by Administration or their diligence with lack Software updates for vulnerable software is local problem that can be easily fixed, if patches exist and those involved RTFM. Diligence of Third-Party installations/devices and how they are exists with in the system in questions:
1. File system interactions, the permissions of that directory tree and contents
2. When, who, how, why some service is running (it/or with `x` method) ? - zero-trust protects!
	1. And the chain of operations that each may have differing permissions
1. Does it have its own Group/Account, does that interacUploadt with system level accounts and kernel in a insecure fashion?
1. Have the third-party developers actually designed it safely for your system, are they configured to be more secure than the defaults!?


#### Permissions and Integrity

[[Windows-Permissions]] reflect the level of privilege of a specific account to perform system-related local operations. Use of some [[Windows-Commands]], [[WMI-Commands]] and [[Windows-Networking-Commands]] are restricted to some accounts. [[Windows-Accounts-Groups]] have unique [security identifier](https://docs.microsoft.com/en-us/windows/win32/secauthz/security-identifiers) (SID), maintain be Windows Local Secruity Authority that assigned objects(Users, groups can be object[[Object-Oriented-Programing]]) and tokens are given access tokens that describe the security context of a given object. Whereas [[Linux-Permissions-and-Rights]] exists more explicitly in [[Linux-File-System]], [[Linux-Networking]], [[Linux-Network-Services]], [[Linux-Processes-Commands]] and [[Linux-Crons]](Linux scheduled tasks), by extension everything is file. Although [[Windows-Processes]] from Vista onwards run on one of four integrity levels, part of the [Windows Integrity Mechanism](https://docs.microsoft.com/en-us/previous-versions/dotnet/articles/bb625957(v=msdn.10)?redirectedfrom=MSDN)

Process | Rights
--- | ---
System integrity process | SYSTEM rights
High integrity process | Administrative rights
Medium integrity process |  Standard user rights
Low integrity process: | Very restricted rights 

Tools like pspy for Linux and SysInternals exist to make more visible the goings-on per system and are useful to have when enumerating a remote system or to defend a local system. 

#### User Account Control
[User Account Control](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-overview): *"User Account Control (UAC) helps prevent malware from damaging a PC and helps organizations deploy a better-managed desktop. With UAC, apps and tasks always run in the security context of a non-administrator account, unless an administrator specifically authorizes administrator-level access to the system. UAC can block the automatic installation of unauthorized apps and prevent inadvertent changes to system settings."*

UAC has two modes:
1. Credential prompt - Provide credentials
2. Consent prompt - Consent to action

UAC logs activity on the machine to allow for the above and notifying Administrative Account to respond to incidents. Even some context where the users is an administrator the account has two security tokens one  on medium and the other on high integrity. Some actions required high integrity  level even as administrative user. For general article on UAC see [[Windows-User-Account-Control]] and for [[Bypassing-Windows-User-Account-Control]]

#### Insecure File Permissions