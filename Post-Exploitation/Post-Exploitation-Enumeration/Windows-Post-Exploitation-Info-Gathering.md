# Windows Post-Exploitation Info-Gathering


```powershell
# Get exact Architecture  
set pro 
```



From the [[Tactical-Post-Exploitation]] talk:

`HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer`
- Last command enter thru the run dialog box
- Recent open dialog box entries
- Save As Dialog Box entries
- Recent Document list by extension
- Recent executables ran
Recent Executables  `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\CIDSizeMRU`
Recent Documents opened and saved by Extension `HKCU\SOftware\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU`
Recent Documents
`HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs`
Recent Run entries
`HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU`

Windows Event Log - Harvest it
- Find what they are looking for
- Find out if they are sending the information somewhere (demonstrates the level of expertise), also the level of possible counter measures on the network - Azure is does this by default.

If `Wecsvc` is  running - run `wecutil` with `es` Enumerate subscription and `gs` enumerated configuration.

Info on file location name and configuration is in:
`HKLM\SYSTEM\CurrentControlSet\Services`
- Beware of the capitalisation of `EVENTLOGS`, `Eventlog` or `eventlog` by OS version.

Post Vista requires permissions and logging of deleting logs logs another log.

#### MMC Enumeration
- Services: `services.msc`
- Scheduled Tasks: `taskschd.msc`
- Sessions: `MMC -> Shared Folders(Local) -> Sessions` 
- Shares: `MMC -> Shared Folders(Local) -> Sessions` 
[iredteam](https://www.ired.team/offensive-security/enumeration-and-discovery/enumerating-users-without-net-services-without-sc-and-scheduled-tasks-without-schtasks)
## References

[Tactical Post Exploitation - by Carlos Perez](https://www.youtube.com/watch?v=gNUhK6G8EQ4)
[iredteam](https://www.ired.team/offensive-security/enumeration-and-discovery/enumerating-users-without-net-services-without-sc-and-scheduled-tasks-without-schtasks)