# macOS-Information-Gathering

```bash
# Get all system preferences and configuration
system_profiler 
# Password POlicy
pwpolicy -gethashtypes -u $user
# Recent applications
defaults read com.apple.recentitems RecentApplication | grep Name
# Recent Remote Host
defaults read com.applerecentitems Host | grep URL
# Lion and SnowLeopard keep a per app recent document list in:
# People like downloading apps, but only use a few.
~/Library/Preferences/<app domain>.LSSharedFileList.plist
# Find files 
# Often files are in b64 and blobs, mdfind uses spotlight function to  
mdfind <blob> 
mdls # list files
# limited to specific directory
mdfind -onlyin ~/Desktop Meta *
# Query for specific metadata parameters  
# || && != ==
mdfind "kMDItemContentType == 'com.microsoft.word.doc' || kMDItemContentType == 'com.adobe.pdf'"
# Use Keyword
kind:<keyword>
# Date Ranges:
Date:this week
# Snow Leopard Hashes
# If we enable smb sharing it will then save the Salted SHA1 as SMB-NT and LANMAN for that password!
# Dump user information including Shadowhashes on Lion:
dscl localhost -read /Search/Users/$username
# Both both Lion and Snowleopard it will display password hint, some user put apssword in the password hint.
# Screenshots - require admin
screenscapture 
# text content of a clipboard 
pbpaste
pwpolicy --get-effective-policy
# secure deletion of files:
srm 
```

System Profiler data types list:
```bash
system_profiler SPSoftwareDataType # OS info
system_profiler SPNetworkDataType
system_profiler SPBluetoothDataType
system_profiler SPEthernetDataType
system_profiler SPPrintersDataType
system_profiler SPUSBDataType
system_profiler SPAirPortDataType
system_profiler SPFirewallDataType
system_profiler SPNetworkLocationDataType
system_profiler SPApplicationDataType
system_profiler SPDeveloperToolsDataType
system_profiler SPLogsDataType
system_profiler SPPrefPaneDataType 
system_profiler SPStartupItemDataType
```


## References

[Tactical Post Exploitation - by Carlos Perez](https://www.youtube.com/watch?v=gNUhK6G8EQ4