# HTTP Request Smuggling

[PortSwigger's HTTP Request Smuggling](https://portswigger.net/web-security/request-smuggling) states: *HTTP request smuggling is a technique for interfering with the way a web site processes sequences of HTTP requests that are received from one or more users. Request smuggling vulnerabilities are often critical in nature, allowing an attacker to bypass security controls, gain unauthorized access to sensitive data, and directly compromise other application users.Request smuggling is primarily associated with HTTP/1 requests. However, websites that support HTTP/2 may be vulnerable, depending on their back-end architecture.*

Given modern web application infrastructure:
![1920](modern-web-applications-http-request-smuggling.excalidraw)
There can be:
- Front-end servers
- Back-end servers
- Databases
- APIs
- Microservices
- Load Balancers
- Reverse Proxies
- Cache Mechanisms - storing data, results for future use - generally to reduce compute and network requests made by infrastructure
	- Content Caching - caching unchanging web content   
	- Database Query caching - caching the results of frequent query 
	- Full-page Caching - Entire page is cache so users do not need to regenerate them
	- Edge Caching/CDNs -  Content Delivery Networks (CDNs) cache content closer to the users
	- API Caching - caching API frequently used or all responses 

## Defining a HTTP Request Smuggling Attack 

HTTP Request Smuggling can occur when multiple different servers interpret HTTP request boundaries and the processing sequences of HTTP requests received create discrepancies in interpretation. 
- Conflicting Headers lead to (most like) undefined prioritisation
		- Both `Content-Length` and `Transfer-Encoding` headers
## Techniques

#### HTTP Request Smuggling CL.TE

CL.TE denotes Content-Length/Transfer-Encoding

#### HTTP Request Smuggling TE.CL

TE.CL denotes Transfer-Encoding/Content-Length

#### Mitigation and Prevention Strategies

1. **Consistent Header Processing**: All servers, whether front-end or back-end, should consistently process headers. Any discrepancy can open the door for smuggling.
2. **Adopt HTTP/2**: HTTP/2 offers a more robust mechanism for handling request boundaries, making it a safer choice against smuggling attacks.
3. **Regular Monitoring and Audits**: Continuously monitor web server traffic for signs of smuggling attempts and conduct regular audits to ensure server configurations are up-to-date and secure.
4. **Educate Teams**: Ensure that development and operations teams are well-informed about the risks of request smuggling and the best practices to prevent it.

## References

[THM HTTP Request Smuggling Room](https://tryhackme.com/room/httprequestsmuggling)
[PortSwigger's HTTP Request Smuggling](https://portswigger.net/web-security/request-smuggling) 